<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抽選応募エージェント | Nintendo Switch 2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
            background: linear-gradient(135deg, #fafafa 0%, #f0f2f5 100%);
            color: #333;
            line-height: 1.5;
            padding: 20px 2px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="0.5" fill="rgba(74,85,104,0.03)"/><circle cx="80" cy="20" r="0.3" fill="rgba(74,85,104,0.03)"/><circle cx="50" cy="50" r="0.4" fill="rgba(74,85,104,0.03)"/><circle cx="30" cy="80" r="0.3" fill="rgba(74,85,104,0.03)"/><circle cx="70" cy="70" r="0.5" fill="rgba(74,85,104,0.03)"/></svg>');
            animation: float 30s infinite linear;
            z-index: 0;
            pointer-events: none;
        }

        @keyframes float {
            0% {
                transform: translateX(-50px) translateY(-50px);
            }

            100% {
                transform: translateX(50px) translateY(50px);
            }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            color: white;
            padding: 24px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        h1 {
            font-size: 1.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 0.95rem;
            opacity: 0.95;
            margin-bottom: 4px;
            position: relative;
            z-index: 1;
        }

        .update-note {
            font-size: 0.85rem;
            opacity: 0.85;
            background: rgba(255, 255, 255, 0.15);
            padding: 8px 16px;
            border-radius: 4px;
            display: inline-block;
            margin-top: 8px;
            position: relative;
            z-index: 1;
        }

        .search-section {
            padding: 16px 24px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .search-box {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: center;
        }

        .search-input {
            padding: 8px 16px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 0.9rem;
            width: 300px;
            transition: all 0.3s ease;
            background: white;
        }

        .search-input:focus {
            outline: none;
            border-color: #495057;
            box-shadow: 0 0 0 2px rgba(73, 80, 87, 0.1);
        }

        .filter-section {
            padding: 16px 24px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .filter-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
            justify-content: center;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #495057;
            position: relative;
            overflow: hidden;
        }

        .filter-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(73, 80, 87, 0.1), transparent);
            transition: left 0.4s;
        }

        .filter-btn:hover::before {
            left: 100%;
        }

        .filter-btn.active {
            background: #495057;
            color: white;
            border-color: #495057;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(73, 80, 87, 0.2);
        }

        .filter-btn:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .filter-btn.active:hover {
            background: #495057;
        }

        .table-container {
            overflow-x: auto;
            padding: 0;
            position: relative;
        }

        .scroll-indicator-top,
        .scroll-indicator-bottom {
            display: none;
            height: 8px;
            background: linear-gradient(90deg, #dee2e6, #6c757d, #dee2e6);
            border-radius: 4px;
            margin: 0 10px;
            opacity: 0.7;
        }

        .scroll-indicator-top {
            margin-bottom: 5px;
        }

        .scroll-indicator-bottom {
            margin-top: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            border-spacing: 0;
        }

        th {
            background: #f8f9fa;
            color: #495057;
            padding: 16px 10px;
            font-weight: 600;
            text-align: left;
            border-bottom: 2px solid #dee2e6;
            white-space: nowrap;
            vertical-align: middle;
            position: relative;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        th:hover {
            background: #e9ecef;
        }

        th.sortable::after {
            content: ' ⇅';
            color: #6c757d;
            font-size: 0.8em;
            margin-left: 4px;
        }

        th.sort-asc::after {
            content: ' ↑';
            color: #495057;
            font-weight: bold;
        }

        th.sort-desc::after {
            content: ' ↓';
            color: #495057;
            font-weight: bold;
        }

        th::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: #495057;
            transition: width 0.3s ease;
        }

        th:hover::before {
            width: 100%;
        }

        td {
            padding: 12px 10px !important;
            border-bottom: 1px solid #f1f3f4;
            vertical-align: middle;
            text-align: left;
            transition: all 0.2s ease;
        }

        td:nth-child(3),
        td:nth-child(4) {
            white-space: nowrap;
        }

        tr:hover {
            background: #f8f9fa;
            transform: scale(1.001);
        }

        .urgent {
            background: linear-gradient(90deg, #fff5f5, #ffffff);
            border-left: 3px solid #dc3545;
            animation: urgentPulse 2s infinite;
        }

        @keyframes urgentPulse {

            0%,
            100% {
                border-left-color: #dc3545;
            }

            50% {
                border-left-color: #ff6b7a;
            }
        }

        .today-ending {
            background: linear-gradient(90deg, #fff3cd, #ffffff);
            border-left: 3px solid #ffc107;
        }

        .very-urgent {
            background: linear-gradient(90deg, #ffe6e6, #ffffff);
            border-left: 3px solid #ff0000;
            animation: veryUrgentPulse 1s infinite;
        }

        @keyframes veryUrgentPulse {

            0%,
            100% {
                border-left-color: #ff0000;
                box-shadow: inset 0 0 5px rgba(255, 0, 0, 0.1);
            }

            50% {
                border-left-color: #ff4444;
                box-shadow: inset 0 0 10px rgba(255, 0, 0, 0.2);
            }
        }

        .store-name {
            font-weight: 600;
            color: #2d3748;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .store-type {
            font-size: 11px;
            color: #6c757d;
            margin-top: 2px;
        }

        .new-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, #ff4757, #ff6b7a);
            color: white;
            font-size: 9px;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 6px rgba(255, 71, 87, 0.3);
            animation: newBadgePulse 2s infinite ease-in-out;
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .new-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: newBadgeShine 3s infinite;
        }

        @keyframes newBadgePulse {

            0%,
            100% {
                transform: scale(1);
                box-shadow: 0 2px 6px rgba(255, 71, 87, 0.3);
            }

            50% {
                transform: scale(1.05);
                box-shadow: 0 3px 12px rgba(255, 71, 87, 0.5);
            }
        }

        @keyframes newBadgeShine {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            text-align: center;
            min-width: 65px;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            animation: glow 2s infinite;
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 5px rgba(21, 87, 36, 0.3);
            }

            50% {
                box-shadow: 0 0 20px rgba(21, 87, 36, 0.6);
            }
        }

        .status-upcoming {
            background: #e6f7ff;
            color: #0050b3;
            border: 1px solid #91d5ff;
        }

        .status-ended {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f1b0b7;
        }

        .status-waiting {
            background: #fffbe6;
            color: #ad8b00;
            border: 1px solid #fff1b8;
        }

        .status-purchase {
            background: #e1f5fe;
            color: #01579b;
            border: 1px solid #b3e5fc;
        }

        .model {
            background: #e9ecef;
            color: #495057;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 11px;
            display: inline-block;
            margin: 1px;
            transition: all 0.2s ease;
        }

        .model:hover {
            background: #dee2e6;
            transform: scale(1.05);
        }

        .period {
            font-weight: 500;
            color: #495057;
            font-size: 12px;
        }

        .condition {
            font-size: 12px;
            color: #6c757d;
            line-height: 1.4;
        }

        .result,
        .deadline {
            font-size: 12px;
            color: #495057;
        }

        .link-btn {
            background: #495057;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }
        
        .app-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 28px;
            background-color: #f0f2f5;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            font-size: 11px;
            font-weight: 500;
            color: #495057;
            text-decoration: none;
            gap: 4px;
        }

        .app-icon svg {
            width: 14px;
            height: 14px;
        }

        .link-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.4s;
        }

        .link-btn:hover::before {
            left: 100%;
        }

        .link-btn:hover {
            background: #343a40;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 58, 64, 0.3);
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 32px;
            padding: 16px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            font-size: 14px;
        }

        .stat-item {
            text-align: center;
            transition: transform 0.2s ease;
        }

        .stat-item:hover {
            transform: translateY(-2px);
        }

        .stat-number {
            font-size: 18px;
            font-weight: 600;
            color: #495057;
        }

        .stat-label {
            color: #6c757d;
            font-size: 12px;
            margin-top: 2px;
        }

        .section-header {
            background: #e9ecef;
            padding: 8px 16px;
            font-weight: 600;
            color: #495057;
            font-size: 13px;
            border-top: 2px solid #dee2e6;
        }

        .section-header td {
            border-bottom: 1px solid #dee2e6;
        }

        .countdown {
            font-size: 10px;
            color: #dc3545;
            font-weight: 600;
            margin-top: 2px;
        }

        .countdown.very-urgent {
            color: #ff0000;
            animation: countdownBlink 1s infinite;
        }

        @keyframes countdownBlink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0.5;
            }
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 1rem;
        }

        @media (max-width: 1200px) {
            .condition {
                font-size: 10px;
            }

            .search-input {
                width: 250px;
            }

            .filter-controls {
                flex-direction: column;
                gap: 12px;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 0 2px;
            }

            .header {
                padding: 16px;
            }

            h1 {
                font-size: 1.4rem;
            }

            th,
            td {
                padding: 8px 6px;
                font-size: 11px;
            }

            .filter-section,
            .search-section {
                padding: 12px 16px;
            }

            .search-input {
                width: 200px;
                font-size: 0.85rem;
            }

            .stats {
                gap: 20px;
                padding: 12px;
            }

            .condition {
                font-size: 9px;
            }

            .scroll-indicator-top,
            .scroll-indicator-bottom {
                display: block;
                animation: scrollHint 2s infinite ease-in-out;
            }

            .filter-controls {
                flex-direction: column;
                gap: 8px;
            }

            .new-badge {
                font-size: 8px;
                padding: 1px 4px;
            }

            .store-name {
                font-size: 12px;
                flex-wrap: wrap;
                gap: 4px;
            }
        }

        @keyframes scrollHint {

            0%,
            100% {
                opacity: 0.4;
                transform: scaleX(1);
            }

            50% {
                opacity: 0.8;
                transform: scaleX(1.1);
            }
        }

        .hidden {
            display: none;
        }

        .last-chance {
            background: linear-gradient(90deg, #ff6b6b20, #ffffff);
            border-left: 4px solid #ff6b6b;
            position: relative;
        }

        .last-chance::before {
            content: '本日締切';
            position: absolute;
            top: 5px;
            right: 10px;
            background: #ff6b6b;
            color: white;
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>抽選応募エージェント | Nintendo Switch 2 完全攻略</h1>
            <div class="subtitle">全国の抽選情報を網羅・分析する専門エージェント | 2025年6月25日現在（最新情報反映版）</div>
            <div class="update-note">【発表済み】ソフマップ, イオンの結果を確認！ | 【明日以降】ファミマ(26日), GEO(27日)など発表多数！ | 【次回予告】ニンテンドーストア(7月上旬), セブンネット(6/26以降)</div>
        </div>

        <div class="search-section">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="店舗名で検索..." id="searchInput">
            </div>
        </div>

        <div class="filter-section">
            <div class="filter-controls">
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterRows('all')">すべて表示</button>
                    <button class="filter-btn" onclick="filterRows('active')">応募受付中</button>
                    <button class="filter-btn" onclick="filterRows('upcoming')">開始予定</button>
                    <button class="filter-btn" onclick="filterRows('waiting')">結果発表待ち</button>
                    <button class="filter-btn" onclick="filterRows('purchase')">購入期間</button>
                </div>
            </div>
        </div>

        <div class="table-container">
            <div class="scroll-indicator-top"></div>
            <table>
                <thead>
                    <tr>
                        <th>店舗名</th>
                        <th>ステータス</th>
                        <th>応募方法</th>
                        <th class="sortable" onclick="sortByColumn('deadline')" data-sort="deadline">受付期間</th>
                        <th>応募条件</th>
                        <th class="sortable" onclick="sortByColumn('result')" data-sort="result">結果発表</th>
                        <th class="sortable" onclick="sortByColumn('purchase')" data-sort="purchase">購入期限</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
            <div class="scroll-indicator-bottom"></div>
            <div id="noResults" class="no-results hidden">
                検索条件に一致する店舗が見つかりませんでした。
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="stat-active">0</div>
                <div class="stat-label">応募受付中</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="stat-upcoming">0</div>
                <div class="stat-label">開始予定</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="stat-waiting">0</div>
                <div class="stat-label">結果発表待ち</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="stat-purchase">0</div>
                <div class="stat-label">購入期間</div>
            </div>
        </div>

    </div>

    <script>
        const TODAY = new Date('2025-06-25');

        function calculateStatus(item) {
            const now = new Date('2025-06-25T20:30:00'); // 現在時刻を反映

            if (item.isOngoing && (!item.endDate || now <= item.endDate)) {
                return 'active';
            }

            if (item.resultDate && item.purchaseDate && now >= item.resultDate && now <= item.purchaseDate) {
                return 'purchase';
            }
            
            if (item.endDate && item.resultDate && now > item.endDate && now < item.resultDate) {
                return 'waiting';
            }

            if (item.startDate && item.endDate) {
                if (now >= item.startDate && now <= item.endDate) {
                    return 'active';
                }
                if (now < item.startDate) {
                    return 'upcoming';
                }
            }
            
            if (item.startDate && !item.endDate) {
                 if (now < item.startDate) {
                    return 'upcoming';
                } else {
                    return 'active';
                }
            }
            
            if(item.resultDate && now < item.resultDate) {
                return 'waiting';
            }

            return 'ended';
        }

        function isStartedToday(item) {
            if (!item.startDate) return false;
            const startDate = new Date(item.startDate);
            const today = new Date(TODAY);
            return startDate.getFullYear() === today.getFullYear() &&
                startDate.getMonth() === today.getMonth() &&
                startDate.getDate() === today.getDate();
        }

        function isEndingToday(item) {
            if (!item.endDate) return false;
            const endDate = new Date(item.endDate);
            const today = new Date(TODAY);
            return endDate.getFullYear() === today.getFullYear() &&
                endDate.getMonth() === today.getMonth() &&
                endDate.getDate() === today.getDate();
        }

        const storeData = [
            {
                store: 'Amazon',
                storeType: 'EC大手 招待制継続中',
                link: 'https://www.amazon.co.jp/dp/B0DX1BC3R8',
                app: false,
                period: '常時リクエスト受付中',
                startDate: new Date('2025-04-24T10:00:00'),
                endDate: null,
                isOngoing: true,
                condition: 'Amazonアカウント必須。商品ページの「招待をリクエスト」ボタンから申込。特別な購入履歴等の条件なし。リクエストは3ヶ月間有効。',
                result: '随時招待メール通知',
                resultDate: null,
                deadline: '招待メール受信後48時間以内',
                purchaseDate: null
            },
            {
                store: 'ノジマオンライン',
                storeType: '家電EC シークレット販売',
                link: 'https://online.nojima.co.jp/',
                app: false,
                period: '不定期開催（常時エントリー受付）',
                startDate: new Date('2025-06-10T10:00:00'),
                endDate: null,
                isOngoing: true,
                condition: 'ノジマオンライン会員登録必須。エントリーページから応募。公式X(@ENETJP)フォローや過去の購入履歴で案内確率が上がるとの情報あり。',
                result: '不定期で当選者のみメール案内',
                resultDate: null,
                deadline: '権利獲得メールに記載',
                purchaseDate: null
            },
            {
                store: 'マイニンテンドーストア',
                storeType: '任天堂公式 第5回予告',
                link: 'https://store-jp.nintendo.com/switch2',
                app: false,
                period: '第5回は7月上旬実施予定',
                startDate: new Date('2025-07-01T12:00:00'),
                endDate: new Date('2025-07-08T18:00:00'),
                condition: '詳細は後日発表。参考(前回条件): ニンテンドーアカウント連携、ソフトプレイ時間、Switch Online加入歴など。',
                result: '詳細未定',
                resultDate: null,
                deadline: '詳細未定',
                purchaseDate: null
            },
            {
                store: 'セブンネットショッピング',
                storeType: 'コンビニ系EC 第3回予告',
                link: 'https://7net.omni7.jp/top',
                app: false,
                period: '6/26以降に実施予定',
                startDate: new Date('2025-06-26T15:00:00'),
                endDate: null,
                condition: '詳細は6/26以降に公式サイト等で発表予定。参考(前回条件): 期間中の購入履歴(1000円以上)、メルマガ受信設定など。',
                result: '詳細未定',
                resultDate: null,
                deadline: '詳細未定',
                purchaseDate: null
            },
            {
                store: 'ソフマップ (Web)',
                storeType: 'PC・家電店 第5回',
                link: 'https://www.sofmap.com/',
                app: false,
                period: '6/19 16:00 〜 6/22 10:00 (終了)',
                startDate: new Date('2025-06-19T16:00:00'),
                endDate: new Date('2025-06-22T10:00:00'),
                condition: 'ソフマップ会員＋EC会員登録・メルマガ購読＋過去2年間の購入履歴必須。',
                result: '6/25 10:00以降 当選者へメール',
                resultDate: new Date('2025-06-25T10:00:00'),
                deadline: 'Web:6/25〜6/27, 店舗:6/28〜7/4',
                purchaseDate: new Date('2025-07-04T23:59:00')
            },
            {
                store: 'イオン',
                storeType: '総合スーパー (アプリ抽選)',
                link: 'https://www.kidsrepublic.jp/about/app.html',
                app: true,
                period: '6/14 〜 6/15 (終了)',
                startDate: new Date('2025-06-14T11:00:00'),
                endDate: new Date('2025-06-15T19:59:00'),
                condition: 'キッズリパブリックアプリからの応募。1回の応募で2回抽選。指定店舗での受取必須。',
                result: '1回目:6/21済, 2回目:6/25 12時〜',
                resultDate: new Date('2025-06-25T12:00:00'),
                deadline: '当選通知に記載',
                purchaseDate: new Date('2025-07-01T23:59:00')
            },
            {
                store: 'ファミリーマート',
                storeType: 'コンビニ (ファミペイアプリ)',
                link: 'https://www.family.co.jp/services/payment/famipay.html',
                app: true,
                period: '6/20 10:00 〜 6/22 23:59 (終了)',
                startDate: new Date('2025-06-20T10:00:00'),
                endDate: new Date('2025-06-22T23:59:00'),
                condition: '6/19時点でファミペイアプリ会員であること。指定店舗での受取必須。',
                result: '6/26 12:00頃 当選者へ通知',
                resultDate: new Date('2025-06-26T12:00:00'),
                deadline: '7/4〜7/10',
                purchaseDate: new Date('2025-07-10T23:59:00')
            },
            {
                store: 'ジョーシン (Web)',
                storeType: '家電量販店 (メール招待)',
                link: 'https://joshinweb.jp/top.html',
                app: false,
                period: '6/13 10:00 〜 6/16 9:59 (終了)',
                startDate: new Date('2025-06-13T10:00:00'),
                endDate: new Date('2025-06-16T09:59:00'),
                condition: '対象会員への個別メール招待のみ。ゴールド/プラチナ/VIP会員＋メルマガ登録など。',
                result: '6/26 夕方以降 発表予定',
                resultDate: new Date('2025-06-26T18:00:00'),
                deadline: '当選通知後案内',
                purchaseDate: null
            },
            {
                store: 'GEO',
                storeType: 'エンタメ店 (アプリ抽選)',
                link: 'https://geo-online.co.jp/html/application.html',
                app: true,
                period: '6/12 11:00 〜 6/17 17:59 (終了)',
                startDate: new Date('2025-06-12T11:00:00'),
                endDate: new Date('2025-06-17T17:59:00'),
                condition: 'GEOアプリから応募。Pontaカード連携必須。未当選者優先システムあり。',
                result: '1回目: 6/20済, 2回目: 6/27 予定',
                resultDate: new Date('2025-06-27T12:00:00'),
                deadline: '2回目: 6/28〜7/1',
                purchaseDate: new Date('2025-07-01T23:59:00')
            },
            {
                store: 'お宝創庫',
                storeType: '中古品店 (アプリ抽選)',
                link: 'https://www.otakarasouko.com/g-lottery/',
                app: true,
                period: '6/16 12:00 〜 6/23 23:45 (終了)',
                startDate: new Date('2025-06-16T12:00:00'),
                endDate: new Date('2025-06-23T23:45:00'),
                condition: 'お宝創庫アプリ会員限定。アプリ内抽選ページから応募。購入履歴不要。',
                result: '6/27 12:00頃 アプリで通知',
                resultDate: new Date('2025-06-27T12:00:00'),
                deadline: '7/4 〜 7/6',
                purchaseDate: new Date('2025-07-06T23:59:00')
            },
            {
                store: '楽天ブックス',
                storeType: 'EC大手 第4回',
                link: 'https://books.rakuten.co.jp/event/game/selling/',
                app: false,
                period: '6/18 10:00 〜 6/19 23:59 (終了)',
                startDate: new Date('2025-06-18T10:00:00'),
                endDate: new Date('2025-06-19T23:59:00'),
                condition: '楽天会員＋過去1年間の楽天ブックス購入履歴必須（電子書籍等除く）。',
                result: '6/27 頃 当選者へメール通知',
                resultDate: new Date('2025-06-27T12:00:00'),
                deadline: '当選通知後案内',
                purchaseDate: null
            },
            {
                store: 'ドン・キホーテ',
                storeType: 'ディスカウント店 (majicaアプリ)',
                link: 'https://www.majica-net.com/app/',
                app: true,
                period: '6/12 10:00 〜 6/19 23:59 (終了)',
                startDate: new Date('2025-06-12T10:00:00'),
                endDate: new Date('2025-06-19T23:59:00'),
                condition: 'majicaアプリから応募。会員限定。指定店舗での受取必須。',
                result: '6/27 頃 アプリで通知',
                resultDate: new Date('2025-06-27T12:00:00'),
                deadline: '当選通知後案内',
                purchaseDate: null
            },
            {
                store: 'MrMax',
                storeType: 'ディスカウント店 (アプリ抽選)',
                link: 'https://www.mrmax.co.jp/app/',
                app: true,
                period: '6/21 12:00 〜 6/23 23:59 (終了)',
                startDate: new Date('2025-06-21T12:00:00'),
                endDate: new Date('2025-06-23T23:59:00'),
                condition: 'MrMaxアプリから応募。期間中の購入履歴不要。店舗受取必須。',
                result: '6/27 15:00頃 アプリで通知',
                resultDate: new Date('2025-06-27T15:00:00'),
                deadline: '6/28 〜 6/30',
                purchaseDate: new Date('2025-06-30T23:59:00')
            },
            {
                store: 'ヤマダデンキ',
                storeType: '家電量販店 (アプリ抽選)',
                link: 'https://www.yamada-denki.jp/service/application/',
                app: true,
                period: '5/30 〜 6/1 (終了)',
                startDate: new Date('2025-05-30T10:00:00'),
                endDate: new Date('2025-06-01T23:59:00'),
                condition: 'ヤマダデジタル会員アプリから応募。期間中の購入実績。1回の応募で3回抽選チャンス。',
                result: '第1,2回: 発表済、第3回: 6/27 予定',
                resultDate: new Date('2025-06-27T18:00:00'),
                deadline: '各回発表後3日間',
                purchaseDate: new Date('2025-06-30T23:59:00')
            },
            {
                store: 'エディオン',
                storeType: '家電量販店 第3回',
                link: 'https://www.edion.com/app/release/lottery.html',
                app: true,
                period: '6/12 10:00 〜 6/15 23:59 (終了)',
                startDate: new Date('2025-06-12T10:00:00'),
                endDate: new Date('2025-06-15T23:59:00'),
                condition: 'エディオンの各種会員(アプリ/ID/カード)いずれかで応募可能。',
                result: 'ネット: 6/24済, 店舗: 6/27 予定',
                resultDate: new Date('2025-06-27T12:00:00'),
                deadline: '当選通知後案内',
                purchaseDate: null
            },
            {
                store: 'ジョーシン (アプリ)',
                storeType: '家電量販店 第5回',
                link: 'https://joshinweb.jp/app.html',
                app: true,
                period: '6/20 0:00 〜 6/22 23:59 (終了)',
                startDate: new Date('2025-06-20T00:00:00'),
                endDate: new Date('2025-06-22T23:59:00'),
                condition: 'VIP/プラチナ/ゴールドスマイル会員限定。ジョーシンアプリから応募。',
                result: '7/4 15:00頃 発表予定',
                resultDate: new Date('2025-07-04T15:00:00'),
                deadline: '7/5〜7/8',
                purchaseDate: new Date('2025-07-08T23:59:00')
            },
            {
                store: 'LOHACO by ASKUL',
                storeType: 'Yahoo!ショッピング系EC',
                link: 'https://lohaco.yahoo.co.jp/',
                app: false,
                period: '6/10 12:00 〜 6/17 11:59 (終了)',
                startDate: new Date('2025-06-10T12:00:00'),
                endDate: new Date('2025-06-17T11:59:00'),
                condition: '過去1年間のYahoo!ショッピング購入履歴必須。転売対策条件あり。',
                result: '6/24 12:00以降 発表済み',
                resultDate: new Date('2025-06-24T12:00:00'),
                deadline: '6/30 23:59まで',
                purchaseDate: new Date('2025-06-30T23:59:00')
            },
            {
                store: 'ビックカメラ',
                storeType: '家電量販店',
                link: 'https://www.biccamera.com/bc/c/sale/special/lottery/switch2_order.html',
                app: false,
                period: '直近の抽選は終了',
                startDate: new Date('2025-06-13T10:00:00'),
                endDate: new Date('2025-06-15T23:59:00'),
                condition: '前回条件: アプリ会員＋過去の購入履歴など。次回開催は公式サイト・アプリで確認。',
                result: '6/20発表済み',
                resultDate: new Date('2025-06-20T10:00:00'),
                deadline: '購入期間終了',
                purchaseDate: new Date('2025-06-23T21:00:00')
            },
            {
                store: 'ヨドバシカメラ',
                storeType: '家電量販店',
                link: 'https://www.yodobashi.com/',
                app: false,
                period: '直近の抽選は終了',
                startDate: new Date('2025-06-06T07:00:00'),
                endDate: new Date('2025-06-09T10:59:00'),
                condition: '前回条件: ヨドバシ会員＋過去の購入履歴など。次回開催は公式サイト・アプリで確認。',
                result: '6/11 発表済み',
                resultDate: new Date('2025-06-11T09:00:00'),
                deadline: '購入期間終了',
                purchaseDate: new Date('2025-06-17T23:59:00')
            },
            {
                store: 'TSUTAYA',
                storeType: 'エンタメ店 (アプリ抽選)',
                link: 'https://tsutaya.tsite.jp/info/game/20250523/index.html',
                app: true,
                period: '直近の抽選は終了',
                startDate: null,
                endDate: null,
                condition: '前回条件: TSUTAYAアプリからの応募。次回開催は公式サイト・アプリで確認。',
                result: 'ー',
                resultDate: null,
                deadline: 'ー',
                purchaseDate: null
            }
        ];

        let currentSortMode = 'priority';
        let currentSortDirection = 'asc';
        let currentFilter = 'all';

        const searchInput = document.getElementById('searchInput');
        const tableBody = document.getElementById('tableBody');
        const noResults = document.getElementById('noResults');

        searchInput.addEventListener('input', function() {
            applyFiltersAndSort();
        });

        function filterRows(status) {
            currentFilter = status;
            const buttons = document.querySelectorAll('.filter-btn');

            buttons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[onclick="filterRows('${status}')"]`).classList.add('active');


            applyFiltersAndSort();
        }

        function sortByColumn(column) {
            if (currentSortMode === column) {
                currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                currentSortMode = column;
                currentSortDirection = 'asc';
            }

            updateSortHeaders();
            applyFiltersAndSort();
        }

        function updateSortHeaders() {
            const headers = document.querySelectorAll('th.sortable');
            headers.forEach(header => {
                header.classList.remove('sort-asc', 'sort-desc');
                if (header.dataset.sort === currentSortMode) {
                    header.classList.add(currentSortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
                }
            });
        }

        window.filterRows = filterRows;
        window.sortByColumn = sortByColumn;

        function applyFiltersAndSort() {
            const searchTerm = searchInput.value.toLowerCase();
            let processedData = storeData.map(item => ({...item, status: calculateStatus(item) }));
            
            let filteredData = processedData.filter(item => {
                const matchesSearch = item.store.toLowerCase().includes(searchTerm);
                const matchesFilter = currentFilter === 'all' || item.status === currentFilter;
                return matchesSearch && matchesFilter;
            });
            
            filteredData.sort((a, b) => {
                 if (currentSortMode === 'priority') {
                    const statusPriority = { 'active': 1, 'purchase': 2, 'upcoming': 3, 'waiting': 4, 'ended': 5 };
                    const priorityA = statusPriority[a.status] || 6;
                    const priorityB = statusPriority[b.status] || 6;

                    if (priorityA !== priorityB) return priorityA - priorityB;

                    let dateA, dateB;
                    if (a.status === 'active' || a.status === 'upcoming') {
                         dateA = a.endDate || a.startDate;
                         dateB = b.endDate || b.startDate;
                    } else { // waiting, purchase, ended
                        dateA = a.resultDate || a.purchaseDate;
                        dateB = b.resultDate || b.purchaseDate;
                    }

                    if (!dateA && !dateB) return 0;
                    if (!dateA) return 1;
                    if (!dateB) return -1;
                    
                    return dateA.getTime() - dateB.getTime();
                } else {
                    let valA, valB;
                    if (currentSortMode === 'deadline') {
                        valA = a.endDate || a.startDate;
                        valB = b.endDate || b.startDate;
                    } else if (currentSortMode === 'result') {
                        valA = a.resultDate;
                        valB = b.resultDate;
                    } else if (currentSortMode === 'purchase') {
                        valA = a.purchaseDate;
                        valB = b.purchaseDate;
                    }

                    if (valA === null || valA === undefined) valA = currentSortDirection === 'asc' ? new Date('2999-12-31') : new Date('1970-01-01');
                    if (valB === null || valB === undefined) valB = currentSortDirection === 'asc' ? new Date('2999-12-31') : new Date('1970-01-01');

                    if (currentSortDirection === 'asc') {
                        return valA.getTime() - valB.getTime();
                    } else {
                        return valB.getTime() - valA.getTime();
                    }
                }
            });

            renderTable(filteredData);
            updateStats(processedData);
        }

        function renderTable(data) {
            let html = '';
            let currentSection = '';

            data.forEach(item => {
                let sectionTitle = '';
                switch (item.status) {
                    case 'active': sectionTitle = '🔥 応募受付中'; break;
                    case 'purchase': sectionTitle = '💰 購入期間'; break;
                    case 'upcoming': sectionTitle = '📅 開始予定'; break;
                    case 'waiting': sectionTitle = '⏳ 結果発表待ち'; break;
                    case 'ended': sectionTitle = '✅ 終了済み'; break;
                    default: sectionTitle = '📢 その他';
                }

                if (sectionTitle !== currentSection) {
                    currentSection = sectionTitle;
                    html += `<tr class="section-header"><td colspan="7"><strong>${sectionTitle}</strong></td></tr>`;
                }
                
                let urgencyClass = '';
                if (isEndingToday(item) && item.status === 'active') {
                    urgencyClass = 'last-chance';
                } else if (item.status === 'purchase') {
                     const now = new Date('2025-06-25T20:30:00');
                     if(item.purchaseDate) {
                         const timeDiff = item.purchaseDate.getTime() - now.getTime();
                         const daysDiff = timeDiff / (1000 * 60 * 60 * 24);
                         if (daysDiff >= 0 && daysDiff < 1) { // 本日が購入最終日の場合にハイライト
                            if(item.purchaseDate.getDate() === now.getDate() && item.purchaseDate.getMonth() === now.getMonth() && item.purchaseDate.getFullYear() === now.getFullYear()) {
                                urgencyClass = 'today-ending';
                            }
                         }
                     }
                }

                const showNewBadge = item.startDate && (new Date('2025-06-25T20:30:00') - new Date(item.startDate)) < 3 * 24 * 60 * 60 * 1000;
                
                const appIconSvg = `
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M11 2a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a3 3 0 0 1 3-3zM5 1a4 4 0 0 0-4 4v6a4 4 0 0 0 4 4h6a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4z"/>
                      <path d="M11.5 5.5a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5m-3 0a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .5-.5m-3 0a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0v-5a.5.5 0 0 1 .5-.5"/>
                    </svg>
                    <span>アプリ応募</span>`;
                
                const linkButton = item.app 
                    ? `<a href="${item.link}" target="_blank" class="app-icon">${appIconSvg}</a>`
                    : `<a href="${item.link}" target="_blank" class="link-btn">${getButtonText(item.status)}</a>`;

                html += `
                    <tr data-status="${item.status}" class="${urgencyClass}" data-store="${item.store}">
                        <td>
                            <div class="store-name">
                                ${item.store}
                                ${showNewBadge ? '<span class="new-badge">NEW</span>' : ''}
                            </div>
                            <div class="store-type">${item.storeType}</div>
                        </td>
                        <td><span class="status status-${item.status}">${getStatusText(item.status)}</span></td>
                        <td>${linkButton}</td>
                        <td><div class="period">${item.period}</div></td>
                        <td><div class="condition">${item.condition}</div></td>
                        <td><div class="result">${item.result}</div></td>
                        <td><div class="deadline">${item.deadline}</div></td>
                    </tr>`;
            });

            tableBody.innerHTML = html;
            noResults.classList.toggle('hidden', data.length > 0);
        }

        function getStatusText(status) {
            const statusMap = { 'active': '受付中', 'upcoming': '開始予定', 'waiting': '発表待ち', 'purchase': '購入期間', 'ended': '終了済み' };
            return statusMap[status] || status;
        }

        function getButtonText(status) {
            const buttonMap = { 'active': '応募リンク', 'upcoming': '確認サイト', 'waiting': '結果確認', 'purchase': '購入サイト', 'ended': '公式サイト' };
            return buttonMap[status] || '公式サイト';
        }

        function updateStats(data) {
            const stats = { active: 0, upcoming: 0, waiting: 0, purchase: 0 };
            data.forEach(item => {
                if (stats.hasOwnProperty(item.status)) {
                    stats[item.status]++;
                }
            });

            Object.keys(stats).forEach(key => {
                const element = document.getElementById(`stat-${key}`);
                if (element) {
                    element.textContent = stats[key];
                }
            });
        }

        // 初期表示
        document.addEventListener('DOMContentLoaded', () => {
            updateSortHeaders();
            applyFiltersAndSort();
        });

    </script>
</body>

</html>
